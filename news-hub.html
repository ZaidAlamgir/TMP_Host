---
layout: default
---

<style>
    @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@900&family=Inter:wght@400&display=swap');
    main { padding: 2rem 1rem 80px 1rem; max-width: 900px; margin: 0 auto; }
    .page-header { text-align: center; margin-bottom: 2.5rem; }
    .page-header h1 { font-size: 2.5rem; color: #1c1e21; }
    .page-header .tag-highlight { color: #0073e6; }
    .page-header p { font-size: 1.1rem; color: #606770; margin-top: 0.5rem; }
    .news-grid-full { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
    .news-card {
        background-color: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        overflow: hidden; text-decoration: none; color: inherit; display: flex; flex-direction: column;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        display: none; /* Initially hidden */
    }
    .news-card.visible { display: flex; } /* Made visible by JS */
    .news-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.12); }
    .news-card .news-card-image-wrapper {
        overflow: hidden; width: 100%; height: 220px; background-color: #e2e8f0;
    }
    .news-card-image {
        width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s ease;
    }
    .news-card:hover .news-card-image { transform: scale(1.05); }
    .news-card-text { padding: 1rem 1.5rem; }
    .news-card-headline {
        font-family: 'Merriweather', serif; font-weight: 900;
        font-size: 1.5rem; color: #1c1e21;
        margin-bottom: 0.5rem; line-height: 1.3;
    }
    .news-card-subheadline {
        font-family: 'Inter', sans-serif; font-weight: 400;
        font-size: 1rem; color: #606770; line-height: 1.6;
    }
    .no-results-message { text-align: center; color: #606770; padding: 2rem; }
    .loader {
        display: none; margin: 2rem auto; border: 4px solid #f3f3f3;
        border-top: 4px solid #0073e6; border-radius: 50%;
        width: 40px; height: 40px; animation: spin 1s linear infinite;
    }
    .loader.visible { display: block; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    @media (min-width: 768px) {
        .news-card { flex-direction: row; }
        .news-card.visible { display: flex; }
        .news-card .news-card-image-wrapper { width: 300px; height: auto; flex-shrink: 0; }
        .news-card-text { display: flex; flex-direction: column; justify-content: center; }
    }
</style>

<main>
    <div class="page-header">
        <h1 id="page-title">News Hub</h1>
        <p id="page-subtitle">The latest trends, research, and important discussions from around the world.</p>
    </div>

    <div class="news-grid-full" id="articles-grid">
        {% assign sorted_posts = site.posts | sort: 'date' | reverse %}
        {% for post in sorted_posts %}
            <a href="{{ post.url | relative_url }}" class="news-card" data-tags="{{ post.tags | join: ',' }}">
                <div class="news-card-image-wrapper">
                    <img src="{{ post.image | default: 'https://placehold.co/600x400/e2e8f0/64748b?text=No+Image' }}" alt="{{ post.image_description | default: 'Article image' }}" class="news-card-image">
                </div>
                <div class="news-card-text">
                    <h3 class="news-card-headline">{{ post.title }}</h3>
                    <p class="news-card-subheadline">{{ post.subheadline | default: 'Click to read more.' }}</p>
                </div>
            </a>
        {% endfor %}
    </div>

    <div id="loader" class="loader"></div>
    <p id="no-results-message" class="no-results-message" style="display: none;"></p>
</main>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const allArticleCards = Array.from(document.querySelectorAll('.news-card'));
    const pageTitle = document.getElementById('page-title');
    const pageSubtitle = document.getElementById('page-subtitle');
    const noResultsMessage = document.getElementById('no-results-message');
    const loader = document.getElementById('loader');

    const BATCH_SIZE = 20;
    let articlesToShow = [];
    let currentIndex = 0;

    const urlParams = new URLSearchParams(window.location.search);
    const tagFilter = urlParams.get('tag');

    if (tagFilter) {
        // --- THIS BLOCK IS MODIFIED ---
        let formattedTag = tagFilter.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        // Specific fix for Art & Culture tag display
        if (tagFilter === 'art-culture') {
            formattedTag = 'Art & Culture';
        }
        // --- END OF MODIFICATION ---

        pageTitle.innerHTML = `News in <span class="tag-highlight">${formattedTag}</span>`;
        pageSubtitle.style.display = 'none';

        articlesToShow = allArticleCards.filter(card => {
            const cardTags = card.dataset.tags.split(',');
            return cardTags.includes(tagFilter);
        });
    } else {
        articlesToShow = allArticleCards;
    }

    function loadNextBatch() {
        if (currentIndex >= articlesToShow.length) {
            loader.classList.remove('visible');
            return; // No more articles to show
        }
        loader.classList.add('visible');
        // Simulate network delay for loading effect
        setTimeout(() => {
            const nextBatch = articlesToShow.slice(currentIndex, currentIndex + BATCH_SIZE);
            nextBatch.forEach(card => card.classList.add('visible'));
            currentIndex += BATCH_SIZE;
            loader.classList.remove('visible'); // Hide loader after batch is added

            // Disconnect observer if all articles are shown
            if (currentIndex >= articlesToShow.length) {
                observer.disconnect();
            }
        }, 300); // 300ms delay
    }

    // Initial load or no results message
    if (articlesToShow.length > 0) {
        loadNextBatch(); // Load the first batch
    } else {
        const message = tagFilter
            ? `No articles found for the category "${formattedTag}".` // Use the corrected formattedTag here too
            : "No articles have been published yet.";
        noResultsMessage.textContent = message;
        noResultsMessage.style.display = 'block';
    }

    // Setup Intersection Observer to load more when loader is visible
    const observer = new IntersectionObserver((entries) => {
        // Check if the loader element is intersecting (visible in the viewport)
        if (entries[0].isIntersecting) {
            loadNextBatch();
        }
    }, {
        root: null, // Use the viewport as the root
        rootMargin: '0px', // No margin
        threshold: 0.1 // Trigger when 10% of the loader is visible
    });

    // Start observing the loader element only if there are articles
    if (articlesToShow.length > 0) {
        observer.observe(loader);
    }
});
</script>