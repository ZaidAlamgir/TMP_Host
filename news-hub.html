---
layout: default
title: News Hub
---

<style>
    /* Styles for the News Hub Page */
    main { padding: 2rem 1rem 80px 1rem; max-width: 900px; margin: 0 auto; }
    .page-header { text-align: center; margin-bottom: 2.5rem; }
    .page-header h1 { font-size: 2.5rem; color: #1c1e21; }
    .page-header .tag-highlight { color: #0073e6; }
    .page-header p { font-size: 1.1rem; color: #606770; margin-top: 0.5rem; }

    .news-grid-full { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }

    .news-card {
        background-color: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        overflow: hidden; text-decoration: none; color: inherit; display: flex; flex-direction: column;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        /* NEW: Hide cards by default for JS loading */
        display: none;
    }
    .news-card.visible {
        /* NEW: Use flex for visible cards */
        display: flex;
    }

    .news-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.12); }

    .news-card .news-card-image-wrapper {
        overflow: hidden; width: 100%; height: 220px; background-color: #e2e8f0;
    }
    .news-card-image {
        width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s ease;
    }
    .news-card:hover .news-card-image { transform: scale(1.05); }

    .news-card-text { padding: 1.5rem; }
    .news-card-headline { font-size: 1.3rem; font-weight: 600; color: #1c1e21; margin-bottom: 0.5rem; }
    .news-card-subheadline { font-size: 1rem; color: #606770; line-height: 1.5; }

    .no-results-message { text-align: center; color: #606770; padding: 2rem; }

    /* NEW: Loader for infinite scroll */
    .loader {
        display: none; margin: 2rem auto; border: 4px solid #f3f3f3;
        border-top: 4px solid #0073e6; border-radius: 50%;
        width: 40px; height: 40px; animation: spin 1s linear infinite;
    }
    .loader.visible { display: block; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }


    @media (min-width: 768px) {
        .news-card { flex-direction: row; }
        .news-card.visible { display: flex; } /* Ensure it works on desktop too */
        .news-card .news-card-image-wrapper { width: 300px; height: auto; flex-shrink: 0; }
        .news-card-text { display: flex; flex-direction: column; justify-content: center; }
    }
</style>

<main>
    <div class="page-header">
        <h1 id="page-title">News Hub</h1>
        <p id="page-subtitle">The latest trends, research, and important discussions from around the world.</p>
    </div>

    <div class="news-grid-full" id="articles-grid">
        {% assign sorted_posts = site.posts | sort: 'date' | reverse %}
        {% for post in sorted_posts %}
            <a href="{{ post.url | relative_url }}" class="news-card" data-tags="{{ post.tags | join: ',' }}">
                <div class="news-card-image-wrapper">
                    <img src="{{ post.image | default: 'https://placehold.co/600x400/e2e8f0/64748b?text=No+Image' }}" alt="{{ post.image_description | default: 'Article image' }}" class="news-card-image">
                </div>
                <div class="news-card-text">
                    <h3 class="news-card-headline">{{ post.title }}</h3>
                    <p class="news-card-subheadline">{{ post.subheadline | default: 'Click to read more.' }}</p>
                </div>
            </a>
        {% endfor %}
    </div>

    <div id="loader" class="loader"></div>
    <p id="no-results-message" class="no-results-message" style="display: none;"></p>
</main>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const articlesGrid = document.getElementById('articles-grid');
    const allArticleCards = Array.from(document.querySelectorAll('.news-card'));
    const pageTitle = document.getElementById('page-title');
    const pageSubtitle = document.getElementById('page-subtitle');
    const noResultsMessage = document.getElementById('no-results-message');
    const loader = document.getElementById('loader');

    const BATCH_SIZE = 20;
    let articlesToShow = [];
    let currentIndex = 0;

    // 1. Get the tag from the URL query parameter
    const urlParams = new URLSearchParams(window.location.search);
    const tagFilter = urlParams.get('tag');

    // 2. Filter articles if a tag is present, otherwise use all articles
    if (tagFilter) {
        const formattedTag = tagFilter.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        pageTitle.innerHTML = `News in <span class="tag-highlight">${formattedTag}</span>`;
        pageSubtitle.style.display = 'none';

        articlesToShow = allArticleCards.filter(card => {
            const cardTags = card.dataset.tags.split(',');
            return cardTags.includes(tagFilter);
        });
    } else {
        articlesToShow = allArticleCards;
    }

    // 3. Function to load the next batch of articles
    function loadNextBatch() {
        if (currentIndex >= articlesToShow.length) {
            loader.classList.remove('visible'); // No more articles to load
            return;
        }

        loader.classList.add('visible');

        // Use a short timeout to simulate loading and prevent UI freezing
        setTimeout(() => {
            const nextBatch = articlesToShow.slice(currentIndex, currentIndex + BATCH_SIZE);
            nextBatch.forEach(card => {
                card.classList.add('visible');
            });
            currentIndex += BATCH_SIZE;
            loader.classList.remove('visible');
            
            // If we've reached the end, hide the loader permanently
            if (currentIndex >= articlesToShow.length) {
                observer.disconnect(); // Stop observing
            }
        }, 300); // 300ms delay
    }

    // 4. Initial Load and Messages
    if (articlesToShow.length > 0) {
        loadNextBatch();
    } else {
        const message = tagFilter 
            ? `No articles found for the category "${tagFilter.replace(/-/g, ' ')}".`
            : "No articles have been published yet.";
        noResultsMessage.textContent = message;
        noResultsMessage.style.display = 'block';
    }

    // 5. Setup Intersection Observer for infinite scroll
    const observer = new IntersectionObserver((entries) => {
        // If the loader is intersecting and we have more posts, load the next batch
        if (entries[0].isIntersecting) {
            loadNextBatch();
        }
    }, {
        root: null, // viewport
        rootMargin: '0px',
        threshold: 0.1 // Trigger when 10% of the loader is visible
    });

    // Start observing the loader element
    if (articlesToShow.length > 0) {
        observer.observe(loader);
    }
});
</script>