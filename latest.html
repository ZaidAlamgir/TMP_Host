---
layout: default
title: Latest Article
permalink: /latest/
redirect_to:
  - "{{ site.posts.first.url }}"
---

{% assign latest_post = site.posts.first %}

<style>
    @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;900&family=Inter:wght@400;500;600&display=swap');

    .article-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 0 1rem 2rem 1rem;
        background: transparent;
        color: #111827;
    }

    /* Typography */
    .article-headline {
        font-family: 'Merriweather', serif; font-weight: 900; font-size: 56px;
        color: #111827; line-height: 1.2; margin-bottom: 0.75rem; margin-top: 0.2rem;
    }
    .article-headline.long-headline { font-size: 45px; }
    .article-headline.very-long-headline { font-size: 38px; }

    .article-subheadline {
        font-family: 'Inter', sans-serif; font-size: 18px; color: #4b5563;
        line-height: 1.6; margin-top: 0; margin-bottom: 1.5rem; font-weight: 400;
    }
    .article-subheadline.long-subheadline { font-size: 17px; }

    .article-body p {
        font-family: 'Merriweather', serif; font-size: 18px; line-height: 1.8;
        margin-bottom: 1.5rem; font-weight: 400;
    }

    .article-body a {
        color: #1d4ed8; text-decoration: underline; transition: color 0.2s ease;
    }
    .article-body a:hover { color: #1e3a8a; }

    /* Article Meta & Share Section */
    .article-meta {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid #e5e7eb;
    }
    .article-meta .author-name {
        font-weight: 600; color: #111827; font-family: 'Inter', sans-serif;
    }
    .article-meta .publish-date {
        font-size: 0.9rem; color: #6b7280; font-family: 'Inter', sans-serif;
    }
    .share-container { display: flex; }
    .share-btn {
        display: inline-flex; align-items: center; justify-content: center;
        width: 36px; height: 36px; border-radius: 50%;
        background-color: #f3f4f6; color: #374151;
        border: none; cursor: pointer; font-size: 1rem;
        transition: all 0.2s; text-decoration: none;
    }
    .share-btn:hover {
        background-color: #e5e7eb; transform: translateY(-2px);
    }

    .article-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
        margin-top: 0.5rem;
    }
    .tag {
        background: rgba(220, 38, 38, 0.1); color: #dc2626; padding: 0.25rem 0.75rem;
        border-radius: 4px; font-size: 0.75rem; font-weight: 500; text-transform: uppercase;
    }
     /* Style for figures generated by JS or frontmatter */
    .article-figure {
        max-width: 100%; /* Ensure figure doesn't overflow */
        margin: 2rem auto; /* Consistent margin for figures */
        padding: 0;
        border: none;
    }
    .article-figure img { /* Style image inside the figure */
        max-width: 100%; height: auto; display: block;
        margin: 0 auto; /* Center image within figure */
        border-radius: 8px;
    }
    /* Style images directly within article-body initially (before JS runs) */
    .article-body > p > img:only-child, .article-body > img {
         max-width: 100%; height: auto; display: block;
         margin: 2rem auto; border-radius: 8px;
    }
    .article-image-caption {
        font-family: 'Inter', sans-serif; font-size: 14px; color: #6b7280;
        margin-top: 0.5rem; /* Reduced top margin for captions */
        margin-bottom: 2rem;
        text-align: center;
        display: block; /* Ensure it takes block space */
    }
    .article-body h2 {
        font-family: 'Merriweather', serif; font-weight: 700; font-size: 1.8rem;
        margin-top: 2.5rem; margin-bottom: 1rem;
    }
     .article-body h3 { font-family: 'Merriweather', serif; font-weight: 700; font-size: 1.5rem; margin-top: 2rem; margin-bottom: 1rem; }
     .article-body h4 { font-family: 'Merriweather', serif; font-weight: 700; font-size: 1.2rem; margin-top: 1.5rem; margin-bottom: 1rem; }
    .article-body blockquote {
        border-left: 3px solid #ccc; padding-left: 1.5rem; margin: 2rem 0;
        font-style: italic; color: #606770; font-size: 1.2rem;
    }
    .embed-container {
        position: relative; padding-bottom: 56.25%; height: 0;
        overflow: hidden; max-width: 100%; margin: 2rem auto; border-radius: 8px;
    }
    .embed-container iframe {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    }
    .embed-caption {
        font-family: 'Inter', sans-serif; font-size: 14px;
        color: #6b7280; margin-top: 0.5rem; text-align: center;
    }

    /* Mobile Styles */
    @media (max-width: 768px) {
        .article-headline { font-size: 32px; }
        .article-headline.long-headline { font-size: 34px; }
        .article-headline.very-long-headline { font-size: 30px; }
        .article-subheadline { font-size: 18px; font-weight: 400; }
    }
</style>

<div class="article-container">
    {% if latest_post %}
        <article>
            <header>
                {% if latest_post.tags and latest_post.tags.size > 0 %}
                <div class="article-tags">
                    {% for tag in latest_post.tags %}
                        <span class="tag">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}

                {% assign headline_length = latest_post.title | size %}
                <h1 class="article-headline {% if headline_length > 80 %}very-long-headline{% elsif headline_length > 50 %}long-headline{% endif %}">
                    {{ latest_post.title }}
                </h1>

                {% if latest_post.subheadline %}
                    {% assign subheadline_length = latest_post.subheadline | size %}
                    <p class="article-subheadline {% if subheadline_length > 200 %}long-subheadline{% endif %}">
                        {{ latest_post.subheadline }}
                    </p>
                {% endif %}

                <div class="article-meta">
                    <div class="meta-info">
                        <div class="author-name">By {{ latest_post.author | default: 'Staff Writer' }}</div>
                        <div class="publish-date">{{ latest_post.date | date: "%B %d, %Y" }}</div>
                    </div>
                    <div class="share-container">
                        <button id="native-share-button" class="share-btn" title="Share article">
                            <i class="fas fa-share-alt"></i>
                        </button>
                    </div>
                </div>
            </header>

            <div class="article-body">
                {% if latest_post.image %}
                <figure class="article-figure">
                    <img src="{{ latest_post.image }}" alt="{{ latest_post.image_description | default: 'Article main image' }}">
                    {% if latest_post.image_description %}
                        <figcaption class="article-image-caption">{{ latest_post.image_description }}</figcaption>
                    {% endif %}
                </figure>
                {% endif %}

                {{ latest_post.content | markdownify }}
            </div> <script>
            document.addEventListener('turbo:load', () => {
                // console.log("Caption script running for latest layout..."); // For debugging
                const articleBody = document.querySelector('.article-body');
                if (!articleBody) {
                    // console.log("Article body not found."); // For debugging
                    return;
                }

                // Find images that are direct children of article-body OR the only child of a paragraph within article-body
                // AND crucially, are NOT already inside a FIGURE element.
                 const images = articleBody.querySelectorAll('.article-body > img:not(figure img), .article-body > p:has(> img:only-child) img');
                // console.log(`Found ${images.length} potential images for captions.`); // For debugging

                images.forEach((img, index) => {
                    // Double-check it's not already processed or inside a figure
                    if (img.closest('figure')) {
                         // console.log(`Image ${index} skipped, already in figure.`); // For debugging
                         return;
                    }

                    const altText = img.getAttribute('alt');
                    // console.log(`Image ${index} alt: "${altText}"`); // For debugging

                    // Check if alt text is meaningful
                    const hasMeaningfulAlt = altText && altText.trim() !== '' && altText.toLowerCase() !== 'article image' && altText.toLowerCase() !== 'image';

                    // Check if wrapping is needed (either for caption or just styling)
                     const needsWrapping = img.parentElement && img.parentElement.tagName !== 'FIGURE';


                     if (needsWrapping) {
                        const figure = document.createElement('figure');
                        figure.classList.add('article-figure');
                        const clonedImg = img.cloneNode(true); // Clone before potential removal
                        figure.appendChild(clonedImg); // Add image first

                        if (hasMeaningfulAlt) {
                            const figcaption = document.createElement('figcaption');
                            figcaption.classList.add('article-image-caption');
                            figcaption.textContent = altText;
                            figure.appendChild(figcaption); // Then add caption if alt text exists
                            // console.log(`Image ${index}: Added caption: "${altText}"`); // For debugging
                        }

                        // Perform replacement
                        const parent = img.parentElement;
                        if (parent && parent.tagName === 'P' && parent.children.length === 1 && parent.childNodes.length === 1) {
                            // If img is the sole content of a paragraph, replace the paragraph
                            // console.log(`Image ${index}: Replacing parent P with figure.`); // For debugging
                            parent.parentNode.replaceChild(figure, parent);
                        } else {
                            // If img is a direct child or inline, replace the image itself
                            // console.log(`Image ${index}: Replacing img with figure.`); // For debugging
                             img.parentNode.replaceChild(figure, img);
                        }
                    } else {
                        // console.log(`Image ${index} skipped (already in figure or no parent).`); // For debugging
                    }
                });
                // console.log("Caption script finished for latest layout."); // For debugging
            });
            </script>
            </article>
    {% else %}
        <p style="text-align: center;">No posts have been published yet.</p>
    {% endif %}
</div> <script> // Share Script
document.addEventListener('turbo:load', () => {
    const shareButton = document.getElementById('native-share-button');

    if (shareButton) {
        shareButton.addEventListener('click', async () => {
            const postUrl = window.location.href;
            const postTitle = "{{ latest_post.title | escape }}"; // Correct variable for this page
            const postText = `Read the article: "${postTitle}"`;

            if (window.AndroidInterface && typeof window.AndroidInterface.share === 'function') {
                window.AndroidInterface.share(postTitle, postText, postUrl);
            } else if (navigator.share) {
                try {
                    await navigator.share({ title: postTitle, text: postText, url: postUrl });
                } catch (err) { console.error('Web Share failed:', err.message); }
            } else {
                try {
                    await navigator.clipboard.writeText(postUrl);
                    const originalIcon = shareButton.innerHTML;
                    shareButton.innerHTML = '<i class="fas fa-check"></i>';
                    shareButton.title = 'Link copied!';
                    setTimeout(() => {
                        shareButton.innerHTML = originalIcon;
                        shareButton.title = 'Share article';
                    }, 2000);
                } catch (err) { alert('Could not copy link. Please copy the URL from the address bar.'); }
            }
        });
    }
});
</script>

<script> // Embed Script
document.addEventListener('turbo:load', () => {
    const articleBody = document.querySelector('.article-body');
    if (!articleBody) return;

    articleBody.querySelectorAll('p > a:only-child').forEach(link => {
        const match = link.textContent.match(/^\[(\w+[-\w]*)\|?(.*)\]$/);

        if (match) {
            const platform = match[1].toLowerCase();
            const caption = match[2];
            const url = link.href;
            let embedHtml = '';

            switch (platform) {
                case 'youtube':
                    const videoId = new URL(url).searchParams.get('v');
                    if (videoId) {
                        embedHtml = `<div class="embed-container"><iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>`;
                    }
                    break;
                case 'twitter':
                case 'twitter-video':
                     embedHtml = `<blockquote class="twitter-tweet"><a href="${url}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`;
                    break;
                // Add cases for other platforms if needed
            }

            if (embedHtml) {
                const container = document.createElement('div');
                container.innerHTML = embedHtml;
                if (caption) {
                    const captionEl = document.createElement('p');
                    captionEl.className = 'embed-caption';
                    captionEl.textContent = caption;
                    container.appendChild(captionEl);
                }
                // Check if the parent is a paragraph before replacing
                if (link.parentElement && link.parentElement.tagName === 'P') {
                     link.parentElement.parentNode.replaceChild(container, link.parentElement);
                } else {
                     // If not in a paragraph (less likely), replace the link itself
                     link.parentNode.replaceChild(container, link);
                }
            }
        }
    });
});
</script>