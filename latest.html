---
layout: default
title: Latest Article
permalink: /latest.html
---

{% assign latest_post = site.posts.first %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ latest_post.url | absolute_url }}"
  },
  "headline": "{{ latest_post.title | escape }}",
  "image": [
    "{{ latest_post.image | absolute_url }}"
   ],
  "datePublished": "{{ latest_post.date | date_to_xmlschema }}",
  "dateModified": "{{ latest_post.date | date_to_xmlschema }}",
  "author": {
    "@type": "Person",
    "name": "{{ latest_post.author | default: 'TMP Staff' | escape }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "The Muslim Post",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ '/android-chrome-512x512.png' | absolute_url }}"
    }
  },
  "description": "{{ latest_post.subheadline | default: latest_post.content | strip_html | truncatewords: 50 | escape }}"
}
</script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;900&family=Inter:wght@400;500;600&display=swap');

    .article-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 0 1rem 2rem 1rem;
        background: transparent;
        color: #111827;
    }

    /* Typography */
    .article-headline {
        font-family: 'Merriweather', serif; font-weight: 900; font-size: 56px;
        color: #111827; line-height: 1.2; margin-bottom: 0.75rem; margin-top: 0.2rem;
    }
    .article-headline.long-headline { font-size: 45px; }
    .article-headline.very-long-headline { font-size: 38px; }

    .article-subheadline {
        font-family: 'Inter', sans-serif; font-size: 18px; color: #4b5563;
        line-height: 1.6; margin-top: 0; margin-bottom: 1.5rem; font-weight: 400;
    }
    .article-subheadline.long-subheadline { font-size: 17px; }

    .article-body p {
        font-family: 'Merriweather', serif; font-size: 18px; line-height: 1.8;
        margin-bottom: 1.5rem; font-weight: 400;
    }

    .article-body a {
        color: #1d4ed8; text-decoration: underline; transition: color 0.2s ease;
    }
    .article-body a:hover { color: #1e3a8a; }

    /* --- ADDED TABLE STYLES (Missing in previous version) --- */
    .table-scroll-wrapper { position: relative; margin: 1.5rem 0; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); }
    .article-body .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; width: 100%; background: white; }
    .article-body table { width: 100%; border-collapse: collapse; min-width: 600px; font-family: 'Inter', sans-serif; font-size: 15px; margin: 0; }
    .article-body caption { caption-side: bottom; padding: 8px; font-size: 0.85rem; color: #6b7280; text-align: left; border-top: 1px solid #f3f4f6; background: #fdfdfd; font-style: italic; }
    .article-body th, .article-body td { padding: 12px 16px; vertical-align: top; line-height: 1.5; color: #374151; }
    .article-body th { background-color: #f8fafc; font-weight: 700; text-align: left; color: #111827; white-space: nowrap; border-bottom: 2px solid #e2e8f0; }
    .article-body td { border-bottom: 1px solid #f1f5f9; }
    .article-body tr:last-child td { border-bottom: none; }
    .table-container.striped tr:nth-child(even) { background-color: #f9fafb; }
    .table-container.grid table { border: 1px solid #cbd5e1; }
    .table-container.grid th, .table-container.grid td { border: 1px solid #cbd5e1; }
    table.sortable th { cursor: pointer; user-select: none; position: relative; padding-right: 24px; }
    table.sortable th:hover { background-color: #eff6ff; color: #1d4ed8; }
    table.sortable th::after { content: '\f0dc'; font-family: "Font Awesome 6 Free"; font-weight: 900; position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #9ca3af; font-size: 10px; opacity: 0.5; }
    /* -------------------------------------------------------- */

    /* Article Meta & Share Section */
    .article-meta {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid #e5e7eb;
    }
    .article-meta .author-name {
        font-weight: 600; color: #111827; font-family: 'Inter', sans-serif;
    }
    .article-meta .publish-date {
        font-size: 0.9rem; color: #6b7280; font-family: 'Inter', sans-serif;
    }
    .share-container { display: flex; }
    .share-btn {
        display: inline-flex; align-items: center; justify-content: center;
        width: 36px; height: 36px; border-radius: 50%;
        background-color: #f3f4f6; color: #374151;
        border: none; cursor: pointer; font-size: 1rem;
        transition: all 0.2s; text-decoration: none;
    }
    .share-btn:hover {
        background-color: #e5e7eb; transform: translateY(-2px);
    }

    .article-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
        margin-top: 0.5rem;
    }
    .tag {
        background: rgba(220, 38, 38, 0.1); color: #dc2626; padding: 0.25rem 0.75rem;
        border-radius: 4px; font-size: 0.75rem; font-weight: 500; text-transform: uppercase;
    }
     /* Style for figures generated by JS or frontmatter */
    .article-figure {
        max-width: 100%; /* Ensure figure doesn't overflow */
        margin: 2rem auto; /* Consistent margin for figures */
        padding: 0;
        border: none;
    }
    .article-figure img { /* Style image inside the figure */
        max-width: 100%; height: auto; display: block;
        margin: 0 auto; /* Center image within figure */
        border-radius: 8px;
    }
    /* Style images directly within article-body initially (before JS runs) */
    .article-body > p > img:only-child, .article-body > img {
         max-width: 100%; height: auto; display: block;
         margin: 2rem auto; border-radius: 8px;
    }
    .article-image-caption {
        font-family: 'Inter', sans-serif; font-size: 14px; color: #6b7280;
        margin-top: 0.5rem; /* Reduced top margin for captions */
        margin-bottom: 2rem;
        text-align: center;
        display: block; /* Ensure it takes block space */
    }
    .article-body h2 {
        font-family: 'Merriweather', serif; font-weight: 700; font-size: 1.8rem;
        margin-top: 2.5rem; margin-bottom: 1rem;
    }
     .article-body h3 { font-family: 'Merriweather', serif; font-weight: 700; font-size: 1.5rem; margin-top: 2rem; margin-bottom: 1rem; }
     .article-body h4 { font-family: 'Merriweather', serif; font-weight: 700; font-size: 1.2rem; margin-top: 1.5rem; margin-bottom: 1rem; }
    .article-body blockquote {
        border-left: 3px solid #ccc; padding-left: 1.5rem; margin: 2rem 0;
        font-style: italic; color: #606770; font-size: 1.2rem;
    }
    .embed-container {
        position: relative; padding-bottom: 56.25%; height: 0;
        overflow: hidden; max-width: 100%; margin: 2rem auto; border-radius: 8px;
    }
    .embed-container iframe {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    }
    .embed-caption {
        font-family: 'Inter', sans-serif; font-size: 14px;
        color: #6b7280; margin-top: 0.5rem; text-align: center;
    }

    /* Mobile Styles */
    @media (max-width: 768px) {
        .article-headline { font-size: 32px; }
        .article-headline.long-headline { font-size: 34px; }
        .article-headline.very-long-headline { font-size: 30px; }
        .article-subheadline { font-size: 18px; font-weight: 400; }
    }
</style>

<div class="article-container">
    {% if latest_post %}
        <article>
            <header>
                {% if latest_post.tags and latest_post.tags.size > 0 %}
                <div class="article-tags">
                    {% for tag in latest_post.tags %}
                        <span class="tag">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}

                {% assign headline_length = latest_post.title | size %}
                <h1 class="article-headline {% if headline_length > 80 %}very-long-headline{% elsif headline_length > 50 %}long-headline{% endif %}">
                    {{ latest_post.title }}
                </h1>

                {% if latest_post.subheadline %}
                    {% assign subheadline_length = latest_post.subheadline | size %}
                    <p class="article-subheadline {% if subheadline_length > 200 %}long-subheadline{% endif %}">
                        {{ latest_post.subheadline }}
                    </p>
                {% endif %}

                <div class="article-meta">
                    <div class="meta-info">
                        <div class="author-name">By {{ latest_post.author | default: 'Staff Writer' }}</div>
                        <div class="publish-date">{{ latest_post.date | date: "%B %d, %Y" }}</div>
                    </div>
                    <div class="share-container">
                        <button id="native-share-button" class="share-btn" title="Share article">
                            <i class="fas fa-share-alt"></i>
                        </button>
                    </div>
                </div>
            </header>

            <div class="article-body">
                {% if latest_post.image %}
                <figure class="article-figure">
                    <img src="{{ latest_post.image }}" alt="{{ latest_post.image_description | default: 'Article main image' }}">
                    {% if latest_post.image_description %}
                        <figcaption class="article-image-caption">{{ latest_post.image_description }}</figcaption>
                    {% endif %}
                </figure>
                {% endif %}

                {{ latest_post.content | markdownify }}
            </div> 
            
            <script>
            // IMAGE OPTIMIZATION
            document.addEventListener('turbo:load', () => {
                requestAnimationFrame(() => {
                    const articleBody = document.querySelector('.article-body');
                    if (!articleBody) return;

                    const images = articleBody.querySelectorAll('.article-body > img:not(figure img), .article-body > p:has(> img:only-child) img');
                    
                    images.forEach((img, index) => {
                        if (img.closest('figure')) return;

                        const altText = img.getAttribute('alt');
                        const hasMeaningfulAlt = altText && altText.trim() !== '' && altText.toLowerCase() !== 'article image' && altText.toLowerCase() !== 'image';
                        const needsWrapping = img.parentElement && img.parentElement.tagName !== 'FIGURE';

                        if (needsWrapping) {
                            const figure = document.createElement('figure');
                            figure.classList.add('article-figure');
                            const clonedImg = img.cloneNode(true);
                            clonedImg.setAttribute('loading', 'lazy');
                            figure.appendChild(clonedImg);

                            if (hasMeaningfulAlt) {
                                const figcaption = document.createElement('figcaption');
                                figcaption.classList.add('article-image-caption');
                                figcaption.textContent = altText;
                                figure.appendChild(figcaption);
                            }

                            const parent = img.parentElement;
                            if (parent && parent.tagName === 'P' && parent.children.length === 1 && parent.childNodes.length === 1) {
                                parent.parentNode.replaceChild(figure, parent);
                            } else {
                                img.parentNode.replaceChild(figure, img);
                            }
                        }
                    });
                });
            });

            // --- ADDED TABLE SORTING LOGIC (Missing in previous version) ---
            document.addEventListener('turbo:load', () => {
                const tables = document.querySelectorAll('.table-container.sortable table');
                tables.forEach(table => {
                    if (table.dataset.hasSortListener) return; 
                    table.dataset.hasSortListener = "true";

                    const headers = table.querySelectorAll('th');
                    headers.forEach((header, index) => {
                        header.addEventListener('click', () => {
                            const tbody = table.querySelector('tbody');
                            const rows = Array.from(tbody.querySelectorAll('tr'));
                            const isAsc = header.classList.contains('asc');
                            
                            headers.forEach(h => h.classList.remove('asc', 'desc'));
                            header.classList.toggle('asc', !isAsc);
                            header.classList.toggle('desc', isAsc);
                            
                            const direction = !isAsc ? 1 : -1;
                            const sortedRows = rows.sort((a, b) => {
                                const aCol = a.children[index].textContent.trim();
                                const bCol = b.children[index].textContent.trim();
                                const aNum = parseFloat(aCol.replace(/[^0-9.-]+/g,""));
                                const bNum = parseFloat(bCol.replace(/[^0-9.-]+/g,""));
                                
                                if (!isNaN(aNum) && !isNaN(bNum) && aCol.match(/\d/)) {
                                    return (aNum - bNum) * direction;
                                }
                                return aCol.localeCompare(bCol) * direction;
                            });
                            
                            tbody.innerHTML = '';
                            sortedRows.forEach(row => tbody.appendChild(row));
                        });
                    });
                });
            });
            </script>
        </article>
    {% else %}
        <p style="text-align: center;">No posts have been published yet.</p>
    {% endif %}
</div> 

<script> // Share Script
document.addEventListener('turbo:load', () => {
    const shareButton = document.getElementById('native-share-button');

    if (shareButton) {
        shareButton.addEventListener('click', async () => {
            const postUrl = window.location.href;
            const postTitle = "{{ latest_post.title | escape }}";
            const postText = `Read the article: "${postTitle}"`;

            if (window.AndroidInterface && typeof window.AndroidInterface.share === 'function') {
                window.AndroidInterface.share(postTitle, postText, postUrl);
            } else if (navigator.share) {
                try {
                    await navigator.share({ title: postTitle, text: postText, url: postUrl });
                } catch (err) { console.error('Web Share failed:', err.message); }
            } else {
                try {
                    await navigator.clipboard.writeText(postUrl);
                    const originalIcon = shareButton.innerHTML;
                    shareButton.innerHTML = '<i class="fas fa-check"></i>';
                    shareButton.title = 'Link copied!';
                    setTimeout(() => {
                        shareButton.innerHTML = originalIcon;
                        shareButton.title = 'Share article';
                    }, 2000);
                } catch (err) { alert('Could not copy link. Please copy the URL from the address bar.'); }
            }
        });
    }
});
</script>

<script> // Embed Script
document.addEventListener('turbo:load', () => {
    requestAnimationFrame(() => {
        const articleBody = document.querySelector('.article-body');
        if (!articleBody) return;

        articleBody.querySelectorAll('p > a:only-child').forEach(link => {
            const match = link.textContent.match(/^\[(\w+[-\w]*)\|?(.*)\]$/);

            if (match) {
                const platform = match[1].toLowerCase();
                const caption = match[2];
                const url = link.href;
                let embedHtml = '';

                switch (platform) {
                    case 'youtube':
                        const videoId = new URL(url).searchParams.get('v');
                        if (videoId) {
                            embedHtml = `<div class="embed-container"><iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>`;
                        }
                        break;
                    case 'twitter':
                    case 'twitter-video':
                        embedHtml = `<blockquote class="twitter-tweet"><a href="${url}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`;
                        break;
                }

                if (embedHtml) {
                    const container = document.createElement('div');
                    container.innerHTML = embedHtml;
                    if (caption) {
                        const captionEl = document.createElement('p');
                        captionEl.className = 'embed-caption';
                        captionEl.textContent = caption;
                        container.appendChild(captionEl);
                    }
                    if (link.parentElement && link.parentElement.tagName === 'P') {
                        link.parentElement.parentNode.replaceChild(container, link.parentElement);
                    } else {
                        link.parentNode.replaceChild(container, link);
                    }
                }
            }
        });
    });
});
</script>