---
layout: default
title: Search Results
---

<style>
    .search-container {
        max-width: 900px;
        margin: 2rem auto;
        padding: 0 1rem;
        flex-grow: 1;
    }
    .search-header h1 {
        font-size: 2.5rem;
        font-weight: 900;
        margin-bottom: 1rem;
        color: #1c1e21;
    }
    .search-header h1 span {
        color: #0073e6;
    }
    .search-results-list {
        list-style: none;
        padding: 0;
    }
    .result-item {
        padding: 1.5rem 0;
        border-bottom: 1px solid #e5e7eb;
    }
    .result-item a {
        text-decoration: none;
    }
    .result-item-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1c1e21;
        margin-bottom: 0.5rem;
    }
    .result-item-title:hover {
        text-decoration: underline;
    }
    .result-item-snippet {
        font-size: 1rem;
        color: #606770;
        line-height: 1.6;
    }
    .result-item-date {
        font-size: 0.9rem;
        color: #8a8d91;
        margin-top: 0.75rem;
    }
    .no-results {
        font-size: 1.2rem;
        color: #606770;
        text-align: center;
        padding: 3rem 0;
    }
</style>

<div class="search-container">
    <header class="search-header">
        <h1>Search Results for: <span id="search-term"></span></h1>
    </header>
    
    <ul id="search-results-list" class="search-results-list">
        </ul>
    
    <p id="no-results" class="no-results" style="display: none;">
        No articles found matching your search.
    </p>
</div>

<script>
document.addEventListener('turbo:load', () => {
    
    // 1. Get the search query from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const query = urlParams.get('q');
    
    const searchTermEl = document.getElementById('search-term');
    const resultsListEl = document.getElementById('search-results-list');
    const noResultsEl = document.getElementById('no-results');

    if (!query || !searchTermEl) {
        if(searchTermEl) searchTermEl.textContent = '""';
        if(noResultsEl) noResultsEl.style.display = 'block';
        return;
    }

    const searchTerm = query.toLowerCase().trim();
    searchTermEl.textContent = `"${query}"`;

    // 2. Fetch the search.json data
    fetch('/search.json')
        .then(response => response.json())
        .then(posts => {
            
            // 3. Filter the posts
            const results = posts.filter(post => {
                const title = (post.title || '').toLowerCase();
                const tags = (post.tags || '').toLowerCase();
                const subheadline = (post.subheadline || '').toLowerCase();
                const content = (post.content || '').toLowerCase();
                
                return title.includes(searchTerm) || 
                       tags.includes(searchTerm) ||
                       subheadline.includes(searchTerm) ||
                       content.includes(searchTerm);
            });

            // 4. Render the results
            if (results.length > 0) {
                resultsListEl.innerHTML = ''; // Clear any old results
                noResultsEl.style.display = 'none';
                
                results.forEach(post => {
                    const postDate = new Date(post.date).toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    const li = document.createElement('li');
                    li.className = 'result-item';
                    li.innerHTML = `
                        <a href="${post.url}">
                            <h2 class="result-item-title">${post.title}</h2>
                            <p class="result-item-snippet">${post.subheadline || post.content.substring(0, 150) + '...'}</p>
                            <p class="result-item-date">${postDate}</p>
                        </a>
                    `;
                    resultsListEl.appendChild(li);
                });

            } else {
                // 5. Handle "No Results"
                noResultsEl.style.display = 'block';
            }
        })
        .catch(error => {
            console.error('Error fetching search data:', error);
            resultsListEl.innerHTML = '<p style="color: red;">Could not load search results.</p>';
        });
});
</script>